<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OLIVER Exam Room Orchestrator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="wrapper">
        <header class="hero">
            <div>
                <h1>OLIVER Exam Room Orchestrator</h1>
                <p>Upload enrollment & room data, configure intelligent allocation, and review AI-powered insights.</p>
            </div>
            <div class="hero-metrics">
                <div class="metric" id="metric-students">
                    <span class="metric-value">0</span>
                    <span class="metric-label">Students Parsed</span>
                </div>
                <div class="metric" id="metric-rooms">
                    <span class="metric-value">0</span>
                    <span class="metric-label">Rooms Parsed</span>
                </div>
                <div class="metric" id="metric-capacity">
                    <span class="metric-value">0</span>
                    <span class="metric-label">Total Capacity</span>
                </div>
            </div>
        </header>

        <main class="content">
            <nav class="wizard-nav">
                <div class="wizard-step active" data-step="1">
                    <span class="wizard-index">1</span>
                    <span>Upload Data</span>
                </div>
                <div class="wizard-step" data-step="2">
                    <span class="wizard-index">2</span>
                    <span>Algorithm Setup</span>
                </div>
                <div class="wizard-step" data-step="3">
                    <span class="wizard-index">3</span>
                    <span>Filters & Schedule</span>
                </div>
                <div class="wizard-step" data-step="4">
                    <span class="wizard-index">4</span>
                    <span>Results & Insights</span>
                </div>
            </nav>

            <section class="step active" data-step="1">
                <div class="grid grid-2">
                    <div class="card">
                        <div class="card-header">
                            <h2>Upload Student Data</h2>
                            <p>Supports `processed_enrollment.csv` or similarly structured files.</p>
                        </div>
                        <div class="card-body">
                            <label class="upload-tile">
                                <input type="file" id="enrollment-input" accept=".csv">
                                <span class="icon">üìÑ</span>
                                <span>Choose Enrollment CSV</span>
                            </label>
                            <button class="btn btn-secondary" id="load-enrollment-sample">Load Sample Students</button>
                            <div class="preview" id="enrollment-preview"></div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2>Upload Room Data</h2>
                            <p>Use `rooms_config.csv`, `room.csv`, or a compatible layout (layout/rows ignored).</p>
                        </div>
                        <div class="card-body">
                            <label class="upload-tile">
                                <input type="file" id="rooms-input" accept=".csv">
                                <span class="icon">üè¢</span>
                                <span>Choose Rooms CSV</span>
                            </label>
                            <button class="btn btn-secondary" id="load-rooms-sample">Load Sample Rooms</button>
                            <div class="preview" id="rooms-preview"></div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="step" data-step="2">
                <div class="card">
                    <div class="card-header">
                        <h2>Algorithm & Mixing Strategy</h2>
                    </div>
                    <div class="card-body grid grid-3">
                        <label class="choice-tile">
                            <input type="radio" name="algorithm" value="smart" checked>
                            <span class="choice-title">Smart Randomized Mix</span>
                            <span class="choice-desc">Shuffle multi-course cohorts for unpredictable seating.</span>
                        </label>
                        <label class="choice-tile">
                            <input type="radio" name="algorithm" value="course-wise">
                            <span class="choice-title">Course-Wise Split</span>
                            <span class="choice-desc">Keep rooms dedicated to a single course per slot.</span>
                        </label>
                        <label class="choice-tile">
                            <input type="radio" name="algorithm" value="balanced">
                            <span class="choice-title">Balanced Utilization</span>
                            <span class="choice-desc">Fill larger cohorts first to maximize seat usage.</span>
                        </label>

                        <div class="field">
                            <label for="max-courses" class="field-label">Max Courses Per Room</label>
                            <input type="number" id="max-courses" class="field-input" min="1" value="3">
                        </div>
                        <div class="field">
                            <label for="seed" class="field-label">Random Seed (optional)</label>
                            <input type="text" id="seed" class="field-input" placeholder="Leave blank for system random">
                        </div>
                        <div class="field">
                            <label for="slot-capacity-mode" class="field-label">Seat Fill Mode</label>
                            <select id="slot-capacity-mode" class="field-input">
                                <option value="greedy" selected>Greedy fill (default)</option>
                                <option value="strict">Strict (keep leftovers for next room)</option>
                            </select>
                        </div>
                    </div>
                </div>
            </section>

            <section class="step" data-step="3">
                <div class="card card--filters">
                    <div class="card-header">
                        <h2>Optional Filters</h2>
                        <p>Pick a semester to see its courses. Leave everything unchecked to schedule every cohort.</p>
                    </div>
                    <div class="card-body filters-body">
                        <div id="filters-container"></div>
                        <div class="filters-summary-row">
                            <div class="filter-summary" id="semester-summary"></div>
                            <div class="filters-actions">
                                <button class="btn btn-chip" type="button" id="clear-semesters">Clear Semesters</button>
                                <button class="btn btn-chip" type="button" id="clear-courses">Clear Courses</button>
                            </div>
                        </div>
                        <div class="filter-summary" id="course-summary"></div>
                        <div class="filter-note" id="filter-note"></div>
                    </div>
                </div>

                <div class="card card--schedule">
                    <div class="card-header">
                        <h2>Exam Window & Slots</h2>
                        <p>Provide the exam window; slots will be generated automatically for every day in the range.</p>
                    </div>
                    <div class="card-body">
                        <div class="grid grid-2 gap-md exam-window-grid">
                            <div class="field">
                                <label for="schedule-start" class="field-label">Exam Start Date</label>
                                <input type="date" id="schedule-start" class="field-input">
                            </div>
                            <div class="field">
                                <label for="schedule-end" class="field-label">Exam End Date</label>
                                <input type="date" id="schedule-end" class="field-input">
                            </div>
                            <div class="field">
                                <label for="slots-per-day" class="field-label">Slots per Day</label>
                                <input type="number" id="slots-per-day" class="field-input" min="1" value="2">
                            </div>
                        </div>
                        <div class="slot-config-wrapper">
                            <div class="slot-config-header">
                                <div>
                                    <h3>Daily Slot Templates</h3>
                                    <p>Labels and times apply to each day between the selected start and end dates.</p>
                                </div>
                                <button class="btn btn-chip" type="button" id="add-slot-template">Add Slot</button>
                            </div>
                            <div id="slot-config" class="slot-config"></div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="step" data-step="4">
                <section class="card" id="results-card" hidden>
                    <div class="card-header">
                        <div class="card-header__title">
                            <h2>Room Allocation Summary</h2>
                            <p>Detailed per-room placement including slot usage, courses, and semesters.</p>
                        </div>
                        <div class="export-group">
                            <button class="btn btn-secondary" id="export-csv" disabled>Export CSV</button>
                            <button class="btn btn-secondary" id="export-excel" disabled>Export Excel</button>
                            <button class="btn btn-secondary" id="export-pdf" disabled>Export PDF</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="results-container" class="table-responsive"></div>
                    </div>
                </section>

                <section class="card" id="analytics-card" hidden>
                    <div class="card-header">
                        <h2>AI / ML Analytics</h2>
                    </div>
                    <div class="card-body">
                        <div class="insights-grid">
                            <div class="insight">
                                <span class="insight-label">Overall Utilization</span>
                                <span class="insight-value" id="overall-utilization">0%</span>
                            </div>
                            <div class="insight">
                                <span class="insight-label">Unassigned Students</span>
                                <span class="insight-value" id="unassigned-count">0</span>
                            </div>
                            <div class="insight">
                                <span class="insight-label">High Utilization Rooms</span>
                                <span class="insight-value" id="high-util-count">0</span>
                            </div>
                            <div class="insight">
                                <span class="insight-label">Low Utilization Rooms</span>
                                <span class="insight-value" id="low-util-count">0</span>
                            </div>
                        </div>
                        <div class="ai-summary" id="ai-summary"></div>
                        <div class="chart-grid">
                            <div>
                                <h3 class="chart-title">Room Utilization</h3>
                                <canvas id="utilization-chart"></canvas>
                            </div>
                            <div>
                                <h3 class="chart-title">Course Distribution by Slot</h3>
                                <canvas id="slot-distribution-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>
            </section>

            <div class="step-controls">
                <button class="btn btn-outline" id="prev-step">Back</button>
                <button class="btn btn-primary" id="next-step">Next</button>
            </div>
        </main>
    </div>

    <div id="notification-banner" class="notification-banner" role="alert" tabindex="-1" hidden>
        <span class="notification-message"></span>
        <button type="button" id="dismiss-notification" aria-label="Dismiss notification">√ó</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
</body>
</html>

